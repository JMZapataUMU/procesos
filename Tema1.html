<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Procesos estocásticos y series temporales - 2&nbsp; Tema 1. Introducción a los procesos estocásticos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Tema2.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Tema1.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tema 1. Introducción a los procesos estocásticos</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Procesos estocásticos y series temporales</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Presentación</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Tema1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tema 1. Introducción a los procesos estocásticos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Tema2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tema 2. Cadenas de Markov</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Tema3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tema 3. Procesos de Poisson</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Tema4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tema 4. Conceptos básicos en series temporales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Tema5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Tema 5. Métodos de Alisado Exponencial</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#conceptos-básicos-y-ejemplos" id="toc-conceptos-básicos-y-ejemplos" class="nav-link active" data-scroll-target="#conceptos-básicos-y-ejemplos"><span class="header-section-number">2.1</span> Conceptos básicos y ejemplos</a></li>
  <li><a href="#funciones-de-distribución-asociadas-a-un-proceso" id="toc-funciones-de-distribución-asociadas-a-un-proceso" class="nav-link" data-scroll-target="#funciones-de-distribución-asociadas-a-un-proceso"><span class="header-section-number">2.2</span> Funciones de distribución asociadas a un proceso</a></li>
  <li><a href="#procesos-estacionarios-y-débilmente-estacionarios" id="toc-procesos-estacionarios-y-débilmente-estacionarios" class="nav-link" data-scroll-target="#procesos-estacionarios-y-débilmente-estacionarios"><span class="header-section-number">2.3</span> Procesos estacionarios y débilmente estacionarios</a></li>
  <li><a href="#procesos-gaussianos" id="toc-procesos-gaussianos" class="nav-link" data-scroll-target="#procesos-gaussianos"><span class="header-section-number">2.4</span> Procesos gaussianos</a></li>
  <li><a href="#ejemplos-y-simulación" id="toc-ejemplos-y-simulación" class="nav-link" data-scroll-target="#ejemplos-y-simulación"><span class="header-section-number">2.5</span> Ejemplos y simulación</a>
  <ul class="collapse">
  <li><a href="#ruido-blanco-gaussiano" id="toc-ruido-blanco-gaussiano" class="nav-link" data-scroll-target="#ruido-blanco-gaussiano"><span class="header-section-number">2.5.1</span> Ruido blanco gaussiano</a></li>
  <li><a href="#movimiento-browniano" id="toc-movimiento-browniano" class="nav-link" data-scroll-target="#movimiento-browniano"><span class="header-section-number">2.5.2</span> Movimiento Browniano</a></li>
  <li><a href="#procesos-gaussianos-estacionarios-isotrópicos" id="toc-procesos-gaussianos-estacionarios-isotrópicos" class="nav-link" data-scroll-target="#procesos-gaussianos-estacionarios-isotrópicos"><span class="header-section-number">2.5.3</span> Procesos gaussianos estacionarios isotrópicos</a></li>
  <li><a href="#movimiento-browniano-fraccional" id="toc-movimiento-browniano-fraccional" class="nav-link" data-scroll-target="#movimiento-browniano-fraccional"><span class="header-section-number">2.5.4</span> Movimiento Browniano fraccional</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tema 1. Introducción a los procesos estocásticos</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Los procesos estocásticos modelizan cantidades numéricas que cambian con el tiempo de manera aleatoria. Ejemplos del mundo real de estos procesos incluyen:</p>
<ul>
<li><p>Resultados sucesivos en un juego de azar.</p></li>
<li><p>Número de plazas ocupadas en un parking.</p></li>
<li><p>Porcentaje de cielo cubierto en el cielo de Madrid.</p></li>
<li><p>Evolución del precio de activos financieros: acciones, tipos de cambio de divisas o criptomonedas, materias primas, etc.</p></li>
<li><p>Indicadores económicos como la inflación, el precio de la luz, y el IBEX 35.</p></li>
</ul>
<p>Los procesos estocásticos proporcionan marcos matemáticos para modelar y comprender estos fenómenos, lo que permite hacer predicciones y tomar decisiones informadas.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./USDEUR.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Evolución del tipo de cambio Euro/dolar (Fuente: Google Finance)</figcaption>
</figure>
</div>
</div>
</div>
<section id="conceptos-básicos-y-ejemplos" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="conceptos-básicos-y-ejemplos"><span class="header-section-number">2.1</span> Conceptos básicos y ejemplos</h2>
<p>A lo largo de este tema, vamos a fijar un espacio de probabilidad <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> y un subconjunto <span class="math inline">\(\mathbb{T}\subset [0,\infty)\)</span>.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Un <strong>proceso estocástico</strong> <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> es una colección de variables aleatorias reales <span class="math inline">\(X_t\)</span> definidas en el espacio de probabilidad <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span>.</p>
</div>
</div>
<p>Interpretamos <span class="math inline">\(t\)</span> como el tiempo (medido en cierta unidad).</p>
<ul>
<li><p>Si <span class="math inline">\(\mathbb{T}\)</span> es contable (por ejemplo, <span class="math inline">\(\mathbb{T}=\{0&lt;1&lt;2&lt;\ldots\}\)</span>, diremos que el proceso estocástico <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> es de tiempo discreto.</p></li>
<li><p>Si <span class="math inline">\(\mathbb{T}\)</span> es un intervalo (por ejemplo, <span class="math inline">\(\mathbb{T}=[0,T]\)</span> o <span class="math inline">\(\mathbb{T}=[0,\infty)\)</span>, diremos que el proceso estocástico es de tiempo continuo.</p></li>
</ul>
<p>Para cada <span class="math inline">\(t\in\mathbb{T}\)</span> tenemos una variable aleatoria <span class="math inline">\(X_t\)</span>. La variable aleatoria <span class="math inline">\(X_t\)</span> tomará un valor numérico <span class="math inline">\(X_t(\omega)\)</span> para cada <span class="math inline">\(\omega\in\Omega\)</span>. A los posibles valores que toma un proceso estocástico se les llama <strong>estados</strong>.</p>
<ul>
<li><p>Si para cada <span class="math inline">\(t\in \mathbb{T}\)</span> la variable aleatoria <span class="math inline">\(X_t\)</span> es de tipo discreto, diremos que el proceso estocástico <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> es de estado discreto.</p></li>
<li><p>Si para cada <span class="math inline">\(t\in \mathbb{T}\)</span> la variable aleatoria <span class="math inline">\(X_t\)</span> es de tipo continuo, diremos que el proceso estocástico <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> es de estado continuo.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Tabla_tipos_procesos.jpg" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Tipos de procesos estocásticos</figcaption>
</figure>
</div>
</div>
</div>
<p>En lo que sigue, siempre supondremos que <span class="math inline">\(0\in\mathbb{T}\)</span>. Esta condición no es realmente restrictiva, ya que podemos desplazar el tiempo por una constante para garantizar que dicha condición se cumpla.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dado un proceso estocástico <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span>, para cada realización <span class="math inline">\(\omega\in\Omega\)</span>, la colección de números reales <span class="math inline">\((X_t(\omega))_{t\in\mathbb{T}}\)</span> se llama <strong>trayectoria</strong> del proceso.</p>
</div>
</div>
<ul>
<li>Para un proceso estocástico <span class="math inline">\((X_{t})_{t=0,1,2,\ldots}\)</span> de tiempo discreto, cada trayectoria define una sucesión de números reales <span class="math inline">\((x_t)_{t=0,1,2,\ldots}\)</span>.</li>
</ul>
<!-- -->
<ul>
<li>Para un proceso estocástico <span class="math inline">\((X_{t})_{t\in [0,\infty)}\)</span> de tiempo continuo, cada trayectoria define una función real <span class="math inline">\(t\mapsto x(t)\colon [0,\infty)\to\mathbb{R}\)</span>.</li>
</ul>
<p>Cada trayectoria corresponde a una observación particular de la evolución del valor de un proceso estocástico en el tiempo.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
</div>
<div class="callout-body-container callout-body">
<p>Supón que inviertes 100 euros en una cuenta bancaria con tipo de interés anual <span class="math inline">\(R\)</span>, compuesto anualmente. Es decir, si <span class="math inline">\(X_t\)</span> es la cantidad de dinero en el año <span class="math inline">\(t\)</span>, entonces <span class="math display">\[
X_t=100\cdot(1+R)^t\quad\mbox{ para }t=0,1,2,\ldots.
\]</span> Supongamos también que el valor de <span class="math inline">\(R&gt;0\)</span> es fijado cuando metes el dinero en la cuenta y sigue una distribución <span class="math inline">\(\mathrm{Exp}(1)\)</span>.</p>
<p>Para cada observación particular <span class="math inline">\(R=r\)</span> de la variable <span class="math inline">\(R\)</span> tendremos una trayectoria del proceso estocástico <span class="math inline">\((X_t)_{t=0,1,2,\ldots}\)</span>. Podemos simular y dibujar cinco trayectorias de este proceso estocástico mediante el siguiente código en <em>R</em>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">112</span>) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">5</span>  </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">rexp</span>(nsim, <span class="dv">1</span>) </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>tiempo <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>r[<span class="dv">1</span>])<span class="sc">^</span>tiempo</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>colores <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(nsim)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tiempo, x, <span class="at">col=</span>colores[<span class="dv">1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nsim){</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>r[i])<span class="sc">^</span>tiempo</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(tiempo, x, <span class="at">col=</span>colores[i])</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Tema1_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
</div>
<div class="callout-body-container callout-body">
<p>Una moneda es lanzada reiteradas veces. En cada lanzamiento, apostamos un euro a cara, de modo que ganamos un euro si sale cara y perdemos un euro si sale cruz. De esta manera, si <span class="math inline">\(X_t\)</span> es la ganancia acumulada en el lanzamiento <span class="math inline">\(t\)</span>, tendremos que <span class="math inline">\(X_0=0\)</span> y <span class="math display">\[
X_t=X_{t-1}+Y_t\quad\mbox{ para }t=1,2,3,\ldots,
\]</span> donde las variables <span class="math inline">\(Y_1,Y_2,Y_3\ldots\)</span> son indendientes y verfican <span class="math inline">\(\mathbb{P}(Y_t=1)=\frac{1}{2}=\mathbb{P}(Y_t=-1)\)</span>.</p>
</div>
</div>
<p>El proceso del ejemplo anterior es un caso particular de un tipo de proceso el cual introducimos a continuación.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sea una <span class="math inline">\(Y_1,Y_2,Y_3,\ldots\)</span> una sucesión de variables independientes de modo que <span class="math inline">\(\mathbb{P}(Y_t=1)=p\)</span> y <span class="math inline">\(\mathbb{P}(Y_t=1)=1-p\)</span>. Al proceso estocástico <span class="math inline">\((x_t)_{t=0,1,2,\ldots}\)</span> con <span class="math inline">\(X_0=0\)</span> y <span class="math display">\[
X_t=X_{t-1}+Y_t\quad\mbox{ para }t=1,2,3,\ldots,
\]</span> se le llama <strong>paseo aleatorio</strong> (simple). Cuando <span class="math inline">\(p=1/2\)</span> se dice se llama <strong>paseo aleatorio simétrico</strong>.</p>
</div>
</div>
<p>Para cada secuencia de lanzamientos observados, tendremos una trayectoria diferente del proceso estocástico <span class="math inline">\((X_t)_{t=0,1,2,\ldots}\)</span>. Podemos simular y dibujar veinte trayectorias de este proceso estocástico mediante el siguiente código en <em>R</em>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">145</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>nlanzamientos <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">size=</span>nlanzamientos, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(y))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>tiempo <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>nlanzamientos</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>colores <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(nsim)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tiempo, x, <span class="at">col=</span>colores[<span class="dv">1</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nsim){</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">size=</span>nlanzamientos, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(y))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(tiempo, x, <span class="at">col=</span>colores[i])</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Tema1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="funciones-de-distribución-asociadas-a-un-proceso" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="funciones-de-distribución-asociadas-a-un-proceso"><span class="header-section-number">2.2</span> Funciones de distribución asociadas a un proceso</h2>
<p>Dado un proceso estocástico <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span>, cada variable aleatoria <span class="math inline">\(X_t\)</span> tendrá su propia distribución de probabilidad la cual puede ser discreta o continua. Observar un proceso estocástico en un solo tiempo de forma aislada no es útil para describir su comportamiento como función del tiempo, ya que los valores observados en un tiempo pueden condicionar su comportamiento en tiempos distintos. Por ejemplo, en el caso del camino aleatorio simétrico en el que apostamos un euro a cara, si hemos acumulado muchas ganancias en el pasado, la ganancia acumulada seguirá siendo alta en las siguientes jugadas, ya que partimos de una cantidad alta la cual disminuirá a lo sumo en un euro en cada lanzamiento.<br>
Por ese motivo, es necesario estudiar la distribución de probabilidad conjunta a lo largo de varios tiempos.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Supongamos que <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> es un proceso estocástico. Dada una sucesión finita de tiempos <span class="math inline">\(\{t_1&lt;t_2&lt;\ldots&lt;t_n\}\subset \mathbb{T}\)</span>, la función <span class="math inline">\(F_{t_1,t_2,\ldots,t_n}\colon\mathbb{R}^n\to[0,1]\)</span> definida por <span class="math display">\[
F_{t_1,t_2,\ldots,t_n}(x_1,x_2,\ldots,x_n)=\mathbb{P}(X_{t_1}\le x_1, X_{t_2}\le x_2,\ldots,X_{t_n}\le x_n),
\]</span> se llama <strong>función de distribución (marginal) finito dimensional</strong> del proceso <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span>.</p>
</div>
</div>
<p>La función de distribución finito dimensional describe el comportamiento probabilístico del proceso estocástico observado en los distintos tiempos <span class="math inline">\(t_1,t_2,\ldots,t_n\)</span>. La distribución de probabilidad de un proceso está caracterizada por el conjunto de todas las distribuciones finito dimensionales. En particular, dos procesos estocásticos con las mismas funciones de distribución finito dimensionales tendrán un comportamiento probabilístico similar.</p>
<p>En el caso de que <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> sea de estado discreto, entonces dicho comportamiento probabilístico puede ser descrito por medio la función puntual de probabilidad finito dimensional <span class="math display">\[
P_{t_1,t_2,\ldots,t_n}(x_1,x_2,\ldots,x_n)=\mathbb{P}(X_{t_1}=x_1, X_{t_2}=x_2,\ldots,X_{t_n}= x_n).
\]</span> En el caso de que <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> sea de estado continuo, consideraremos la función de densidad finito dimensional <span class="math inline">\(f_{t_1,t_2,\ldots,t_n}(x_1,x_2,\ldots,x_n)\)</span>, la cual verifica <span class="math display">\[
\mathbb{P}(a_1&lt;X_{t_1}&lt;b_1,\ldots,a_n&lt;X_{t_n}&lt;b_n)=\int_{a_n}^{b_n}\cdots \int_{a_1}^{b_1}f_{t_1,t_2,\ldots,t_n}(x_1,x_2,\ldots,x_n) {\mathrm dx_1}\ldots {\mathrm  dx_n}
\]</span> para todo <span class="math inline">\(-\infty\le a_i&lt;b_i\le \infty\)</span>.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dado un proceso estocástico <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> la <strong>función media o función de medias</strong> <span class="math inline">\(\mu_X\colon \mathbb{T}\to \mathbb{R}\)</span> se define como <span class="math display">\[\mu_X(t)=\mathbb{E}(X_t).\]</span></p>
</div>
</div>
<ul>
<li><p>Para un proceso estocástico <span class="math inline">\((X_{t})_{t=0,1,2,\ldots}\)</span> de tiempo discreto, la función media define una sucesión de números reales <span class="math inline">\((\mu_X(t))_{t=0,1,2,\ldots}\)</span>.</p></li>
<li><p>Para un proceso estocástico <span class="math inline">\((X_{t})_{t\in [0,\infty)}\)</span> de tiempo continuo, la función media define una función real <span class="math inline">\(t\mapsto \mu_X(t)\colon [0,\infty)\to\mathbb{R}\)</span>.</p></li>
</ul>
<p>La función de medias da una idea de cómo el proceso estocástico se comporta en promedio a lo largo del tiempo.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
</div>
<div class="callout-body-container callout-body">
<p>Volvamos al ejemplo donde una moneda es lanzada reiteras veces y <span class="math inline">\((X_t)_{t=0,1,2,\ldots}\)</span> son las ganancias acumuladas al apostar un euro a cara en cada lanzamiento (paseo aleatorio simétrico). En este caso, <span class="math inline">\(\mu_X(0)=\mathbb{E}(X_0)=\mathbb{E}(0)=0\)</span> y, si <span class="math inline">\(t&gt;0\)</span>, <span class="math display">\[ \mathbb{E}(X_t)=\mathbb{E}(Y_1+Y_2+\ldots+Y_t)=\mathbb{E}(Y_1)+\mathbb{E}(Y_2)+\ldots+\mathbb{E}(Y_t)=0, \]</span> donde hemos aplicado que <span class="math inline">\(\mathbb{E}(Y_s)=0\)</span> para todo <span class="math inline">\(s\)</span>. En definitiva, la ganancia acumulada promedio es <span class="math inline">\(0\)</span> para cualquier número de lanzamientos efectuado.</p>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dado un proceso estocástico <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> la <strong>función de covarianzas</strong> <span class="math inline">\(C_X\colon \mathbb{T}\times\mathbb{T}\to \mathbb{R}\)</span> se define como <span class="math display">\[ C_X(s,t)={\mathrm  Cov}(X_s,X_t)=\mathbb{E}\Big((X_s-\mu_X(s))(X_t-\mu_X(t)\Big)=\mathbb{E}(X_s X_t)-\mu_X(s)\mu_X(t). \]</span> La <strong>función de varianzas</strong> <span class="math inline">\(\sigma_X^2\colon \mathbb{T}\to \mathbb{R}\)</span> se define como <span class="math display">\[ \sigma_X^2(t)={\mathrm  Var}(X_t)=C_X(t,t), \]</span> y la <strong>función de correlaciones</strong> <span class="math inline">\(\rho_X\colon \mathbb{T}\times\mathbb{T}\to \mathbb{R}\)</span> se define como <span class="math display">\[ \rho_X(s,t)=\frac{C_X(s,t)}{\sigma_X(s)\sigma_X(t)}. \]</span></p>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consideremos el proceso estocástico <span class="math inline">\((X_t)_{t\in [0,\infty)}\)</span> definido como <span class="math display">\[
X_t=A + B t\quad\mbox{ para todo }t,
\]</span> donde <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span> son variables aleatorias <span class="math inline">\(N(1,1)\)</span> independientes. En este caso tenemos <span class="math display">\[\begin{align*}
C_X(s,t)&amp;=\mathbb{E}(X_s X_t)-\mu_X(s)\mu_X(t)\\
&amp;=\mathbb{E}\big((A + B t)(A + B s)\Big)\\
&amp;=\mathbb{E}\big(A B + A B (s + t) + A B s t)\Big)\\
&amp;=\mathbb{E}(A)\mathbb{E}(B) + \mathbb{E}(A)\mathbb{E}(B) (s + t) + \mathbb{E}(A) \mathbb{E}(B) s t\\
&amp;=1 + s + t + st.
\end{align*}\]</span></p>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
</div>
<div class="callout-body-container callout-body">
<p>Volvamos al ejemplo del paseo aleatorio simétrico <span class="math inline">\((X_t)_{t=0,1,2,\ldots}\)</span>. Fijados dos números naturales <span class="math inline">\(n,m\)</span> con <span class="math inline">\(n\le m\)</span>, tenemos <span class="math display">\[\begin{align*}
C_X(n,m)&amp;=\mathbb{E}\Big(X_n X_m\Big)\\
&amp;=\mathbb{E}\Big(X_n (X_m-X_n + X_n)\Big)\\
&amp;=\mathbb{E}\Big(X_n(X_m-X_n)\Big) + \mathbb{E}\Big(X_n^2\Big)\\
&amp;=\mathbb{E}(X_n) \mathbb{E}(X_m-X_n) + \mathbb{E}(X_n^2)\\
&amp;=n=\min(n,m),
\end{align*}\]</span> donde hemos usado que <span class="math inline">\(X_n\)</span> y <span class="math inline">\(X_m-X_n\)</span> son variables aleatorias independientes. Además, obsérvese que, como <span class="math inline">\(X_n=Y_1+Y_2+\ldots + Y_n\)</span> y las variables <span class="math inline">\(Y_1,Y_2,\ldots,Y_n\)</span> son independientes, se tiene que <span class="math display">\[ {\mathrm  Var}(X_n) = {\mathrm  Var}(Y_1^2)+{\mathrm  Var}(Y_2^2)+\ldots + {\mathrm  Var}(Y_n^2)=1+1+\ldots + 1=n, \]</span> y por tanto <span class="math display">\[ \mathbb{E}(X_n^2)={\mathrm  Var}(X_n) +(\mathbb{E}(X_n))^2=n+0=n. \]</span></p>
</div>
</div>
</section>
<section id="procesos-estacionarios-y-débilmente-estacionarios" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="procesos-estacionarios-y-débilmente-estacionarios"><span class="header-section-number">2.3</span> Procesos estacionarios y débilmente estacionarios</h2>
<p>Los procesos estocásticos se pueden dividir entre estacionarios (en sentido estricto), débilmente estacionarios y no estacionarios. Intuitivamente hablando, un proceso estocástico es estacionario (en sentido estricto) si su comportamiento probabilístico o distribución no cambia con el tiempo.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Un proceso estocástico <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> se dice que es <strong>estacionario</strong> si para toda sucesión finita de tiempos <span class="math inline">\(t_1,t_2,\ldots,t_n\)</span> y todo <span class="math inline">\(s&gt;0\)</span> se verifica que los vectores aleatorios <span class="math display">\[
(X_{t_1},X_{t_2},\ldots,X_{t_n})\quad\mbox{ y }\quad (X_{t_1+s},X_{t_2+s},\ldots,X_{t_n+s})
\]</span> tienen la misma función de distribución, es decir, <span class="math display">\[
F_{t_1,t_2,\ldots,t_n}(x_1,x_2,\ldots,x_n)=F_{t_1+s,t_2+s,\ldots,t_n+s}(x_1,x_2,\ldots,x_n)
\]</span> para cualesquiera números reales <span class="math inline">\(x_1,x_2,\ldots, x_n\)</span>.</p>
</div>
</div>
<p>En particular, si un proceso es estacionario, entonces todas las variables aleatorias <span class="math inline">\(X_t\)</span> del proceso tienen la misma distribución, es decir, están idénticamente distribuidas. Esto no implica que los vectores aleatorios que se pueden formar con las variables del proceso en diferentes instantes tengan todos la misma distribución.</p>
<p>En la práctica es muy útil saber si un proceso estocástico es estacionario cuando es necesario predecir el comportamiento futuro de dicho proceso. Si sabemos que el proceso es estacionario, entonces observando su comportamiento en el pasado podremos inferir información de su comportamiento en el futuro.</p>
<p>A continuación introducimos una noción de estacionaridad menos exigente, la cual es también muy útil para predecir comportamientos futuros de procesos estocásticos reales.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Un proceso estocástico <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> se dice que es <strong>débilmente estacionario</strong> si:</p>
<ol type="1">
<li><span class="math inline">\(\mu_X(t)=\mu_X(0)\)</span> para todo <span class="math inline">\(t\in\mathbb{T}\)</span>. Es decir, la función de medias es constante.</li>
<li><span class="math inline">\(C_X(s,t)=C_X(0,t-s)\)</span> para todo <span class="math inline">\(t,s\in\mathbb{T}\)</span> con <span class="math inline">\(s\le t\)</span>. Es decir, la función de covarianzas depende sólo del salto entre tiempos.</li>
</ol>
</div>
</div>
<p>Obsérvese que, en particular, si el proceso es débilmente estacionario tendrá función de varianzas constante.</p>
<p>Dado que la media <span class="math inline">\(\mu_X(t)\)</span> es determinada por la función de distribución marginal <span class="math inline">\(F_t(x)\)</span>, y la covarianza <span class="math inline">\(C_X(s,t)\)</span> es determinada por la función de distribución marginal <span class="math inline">\(F_{s,t}(x)\)</span>, todo proceso estacionario será también débilmente estacionario. Sin embargo, es posible que un proceso sea débilmente estacionario pero no estacionario.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consideremos el proceso estocástico <span class="math inline">\((X_t)_{t\in[0,\infty)}\)</span> definido por <span class="math display">\[
X_t=Y\cos(U+ t),
\]</span> donde <span class="math inline">\(Y\)</span> y <span class="math inline">\(U\)</span> son variables aleatorias independientes con <span class="math inline">\(Y\sim N(0,1)\)</span> y <span class="math inline">\(U\sim U[0,2\pi]\)</span>. Entonces <span class="math display">\[
\mu_X(t)=0,
\]</span> y además, para <span class="math inline">\(s\le t\)</span>, <span class="math display">\[\begin{align*}
C_X(s,t)&amp;=\mathbb{E}(X_s X_t)-\mu_X(s)\mu_X(t)\\
&amp;=\mathbb{E}\big((Y\cos(U+ s))(Y\cos(U+ t))\Big)\\
&amp;=\mathbb{E}(Y^2)\mathbb{E}\Big(\cos(U+ s)\cos(U+ t)\Big)\\
&amp;=\mathbb{E}\Big(\cos(U+ s)\cos(U+ t)\Big)\\
&amp;=\mathbb{E}\Big(\tfrac{1}{2}\cos(2U+ s + t) + \tfrac{1}{2}\cos(t - s)\Big)\\
&amp;=\mathbb{E}\Big(\tfrac{1}{2}\cos(2U+ s + t)\Big) + \tfrac{1}{2}\cos(t - s)\\
&amp;=\tfrac{1}{2}\int_0^{2\pi} (\cos(2u+ s + t) \tfrac{1}{2\pi})du +  \tfrac{1}{2}\cos(t - s)\\  
&amp;=0 +  \tfrac{1}{2}\cos(t - s)\\
&amp;=\tfrac{1}{2}\cos(t - s).
\end{align*}\]</span> En particular, tenemos que <span class="math inline">\(C_X(s,t)=\tfrac{1}{2}\cos(t - s)=C_X(0,t-s)\)</span>, de donde deducimos que el proceso estocástico <span class="math inline">\((X_t)_{t\in[0,\infty)}\)</span> es débilmente estacionario.</p>
</div>
</div>
</section>
<section id="procesos-gaussianos" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="procesos-gaussianos"><span class="header-section-number">2.4</span> Procesos gaussianos</h2>
<p>A continuación introducimos una de las familias de procesos estocásticos más importantes: los procesos gaussianos. Este tipo de procesos tienen importantes aplicaciones en Machine Learning.</p>
<p>Recordemos primero la noción de variable <strong>Normal multivariante</strong>. Una propiedad importante de las variables normales multivariadas es que su función de densidad (y, por tanto, su distribución) está completamente determinada por el vector de medias y la matriz de covarianzas.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Se dice que el vector aleatorio <span class="math inline">\(\vec{X}=(X_1,X_2,\ldots,X_n)\)</span> sigue una distribución Normal multivariante si su función de densidad viene dada por: <span class="math display">\[
f_X(\vec{x}) = \frac{1}{(2\pi)^{n/2}\,\sqrt{|C_X|}}
\exp\left\{-\tfrac{1}{2}(\vec{x}-\vec{\mu}_X)^{T} C_X^{-1} (\vec{x}-\vec{\mu}_X)\right\}
\quad \text{para todo } \vec{x}\in \mathbb{R}^n.
\]</span> donde <span class="math inline">\(\vec\mu_X\)</span> es el vector de medias de <span class="math inline">\(\vec{X}\)</span> y <span class="math inline">\(C_X\)</span> es la matriz de covarianzas de <span class="math inline">\(\vec{X}\)</span>.</p>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Propiedad
</div>
</div>
<div class="callout-body-container callout-body">
<p>Se puede probar, aunque no es inmediato, que una condición equivalente para que el vector aleatorio <span class="math inline">\((X_1,X_2,\ldots,X_n)\)</span> siga una distribución Normal multivariante es que, para cualesquiera números reales <span class="math inline">\(a_1,a_2,\ldots,a_n\)</span>, la variable aleatoria real <span class="math display">\[
a_1 X_1 + a_2 X_2 + \ldots + a_n X_n
\]</span> sigue una distribución Normal univariante.</p>
</div>
</div>
<p>Otra importante propiedad de las variables aleatorias normales multivariadas que conviene recordar es que las transformaciones lineales de estas variables también son normales multivariadas. En otras palabras, si <span class="math inline">\(\vec{X}\)</span> es un vector aleatorio Normal multivariante de tamaño n, <span class="math inline">\(A\)</span> es una matriz constante de tamaño <span class="math inline">\(m\times n\)</span>, y <span class="math inline">\(\vec{b}\)</span> es un vector constante de tamaño <span class="math inline">\(m\)</span>, entonces el vector aleatorio <span class="math inline">\(\vec{Y}=A\vec{X}+\vec{b}\)</span> también es un vector aleatorio Normal multivariante.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Un proceso estocástico <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> se dice que es <strong>gaussiano</strong> (o <strong>Normal</strong>) si para toda sucesión de tiempos <span class="math inline">\(t_1,t_2,\ldots, t_n\in\mathbb{T}\)</span> el vector aleatorio <span class="math display">\[(X_{t_1},X_{t_2},\ldots,X_{t_n})\]</span> es una variable Normal multivariante.</p>
</div>
</div>
<p>Una importante propiedad de los procesos gaussianos es que las nociones de estacionaridad y estacionaridad débil son equivalentes para este tipo de procesos. En la práctica esto significa que para verificar que un proceso gaussiano es estacionario basta analizar su media y covarianza. Concretamente, tenemos lo siguiente.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Teorema
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sea <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> un proceso estocástico gaussiano. Si <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> es débilmente estacionario, entonces es también estacionario.</p>
</div>
</div>
</section>
<section id="ejemplos-y-simulación" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="ejemplos-y-simulación"><span class="header-section-number">2.5</span> Ejemplos y simulación</h2>
<p>En lo que sigue vamos a estudiar y simular en <em>R</em> algunos ejemplos particulares de procesos estocásticos gaussianos, analizando en cada caso si se trata de procesos estacionarios o no estacionarios.</p>
<section id="ruido-blanco-gaussiano" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="ruido-blanco-gaussiano"><span class="header-section-number">2.5.1</span> Ruido blanco gaussiano</h3>
<p>Un proceso estocástico <span class="math inline">\((X_{t})_{t\in\mathbb{T}}\)</span> se llama <strong>ruido blanco gaussiano</strong> si las variables aleatorias <span class="math inline">\(X_t\)</span> son independientes y siguen una distribución <span class="math inline">\(N(0,\sigma^2)\)</span>.</p>
<p>Claramente el ruido blanco gaussiano es un proceso gaussiano. Además, <span class="math inline">\(\mu_X(t)=0\)</span>, <span class="math inline">\(C_X(t,s)=0\)</span> si <span class="math inline">\(t\neq s\)</span>, y <span class="math inline">\(C_X(t,t)=\sigma^2\)</span>. Lo cual en particular implica que el ruido blanco gaussiano es un proceso estacionario.</p>
<p>Podemos simular en R un trayectoria del ruido blanco gaussiano:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>tiempos <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rnorm</span>(<span class="fu">length</span>(tiempos), <span class="dv">0</span>, sigma)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tiempos, x, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Tema1_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Obtenemos una trayectoria extremadamente irregular. Además, observamos a simple vista un comportamiento estacionario del proceso.</p>
</section>
<section id="movimiento-browniano" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="movimiento-browniano"><span class="header-section-number">2.5.2</span> Movimiento Browniano</h3>
<p>Un proceso estocástico <span class="math inline">\((X_{t})_{t\in [0,\infty)}\)</span>, de tiempo continuo, se dice que es un <strong>movimiento Browniano</strong> o proceso de Wiener si:</p>
<ol type="1">
<li><p><span class="math inline">\(X_0=0\)</span>,</p></li>
<li><p>Para todo par de tiempos <span class="math inline">\(s\le t\)</span>, la variable aleatoria <span class="math inline">\(X_{t}-X_{s}\)</span> sigue una distribución <span class="math inline">\(N(0,t-s)\)</span>,</p></li>
<li><p>Para cualquier sucesión de tiempos <span class="math inline">\(t_1&lt;t_2&lt;\ldots&lt;t_n\)</span> se tiene que las variables aleatorias <span class="math display">\[ X_{t_2}-X_{t_1},\quad X_{t_3}-X_{t_2},\quad \ldots,\quad X_{t_n}-X_{t_{n-1}} \]</span> son independientes.</p></li>
<li><p>Las trayectorias <span class="math inline">\(t\mapsto X_t(\omega)\)</span> son funciones continuas.</p></li>
</ol>
<p>El movimiento Browniano se utiliza en finanzas para modelar la evolución del precio de activos financieros como las acciones o los tipos de cambio. En particular, se aplica a la valoración de opciones financieras mediante el modelo de Black-Scholes, y el análisis de riesgos.</p>
<p>A continuación vamos a simular una trayectoria del movimiento Browniano. Para ello fijamos un incremento de tiempo <span class="math inline">\(\Delta t&gt;0\)</span> y un número natural <span class="math inline">\(n\)</span>. Deseamos simular una trayectoria en los instantes de tiempo <span class="math inline">\(t_0=0\)</span>, <span class="math inline">\(t_1=\Delta t\)</span>, …, <span class="math inline">\(t_n=n\Delta t\)</span>. En vista de la definición de movimiento Browniano, tenemos que los incrementos <span class="math display">\[
\Delta X_{t_1}=X_{t_1}-X_{t_0},\quad \Delta X_{t_2}=X_{t_2}-X_{t_1},\quad ...,\quad \Delta X_{t_n}=X_{t_n}-X_{t_{n-1}},  
\]</span> son variables aleatorias idependientes y siguen todas ellas una distribución <span class="math inline">\(N(0,\Delta t)\)</span>. De este modo, nuestra estrategia será simular los valores de los incrementos mediante la generación de una muestra aleatoria de <span class="math inline">\(n\)</span> variables <span class="math inline">\(N(0,\Delta t)\)</span> independientes, y reconstruir la trayectoria del proceso a partir de dichos incrementos. Esto podemos lograrlo mediante el siguiente código de <em>R</em>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>tiempo <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">by=</span>dt)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>incrementos <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fu">sqrt</span>(dt))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(incrementos))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tiempo, x, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Tema1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para analizar el comportamiento probabilístico, simularemos diez trayectorias del proceso:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>tiempos <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">by=</span>dt)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>incrementos <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fu">sqrt</span>(dt))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(incrementos))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>colores <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(nsim)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tiempos, x, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col=</span>colores[<span class="dv">1</span>])</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nsim){</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  incrementos<span class="ot">=</span><span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fu">sqrt</span>(dt))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(incrementos))</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(tiempos, x, <span class="at">col=</span>colores[i])</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Tema1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>A simple vista observamos un comportamiento no estacionario del proceso. Notamos que a medida que avanza el tiempo, las trayectorias tienden a volverse más dispersas, lo que indica que el comportamiento probabilístico de las trayectorias varía con el tiempo.</p>
<p>El movimiento Browniano es un proceso gaussiano. De hecho, la distribución de probabilidad del vector aleatorio <span class="math inline">\((X_{t_1},X_{t_2},\ldots,X_{t_n})\)</span>, para <span class="math inline">\(t_1&lt;t_2&lt;\ldots&lt;t_n\)</span>, es normal multivariada porque se obtiene como una transformación lineal del vector <span class="math inline">\((X_{t_1},X_{t_2}-X_{t_1},\ldots,X_{t_n}-X_{t_{n-1}})\)</span>, el cual es normal multivariado porque sus componentes son independientes y normales. ¿Puedes encontrar dicha transformación lineal?.</p>
<p>Además, <span class="math inline">\(\mu_X(t)=\mathbb{E}(X_t)=0\)</span> y, para <span class="math inline">\(s\le t\)</span>, <span class="math display">\[\begin{align*}
C_X(s,t)&amp;=\mathbb{E}\Big(X_s X_t\Big)\\
&amp;=\mathbb{E}\Big(X_s (X_t-X_s + X_s)\Big)\\
&amp;=\mathbb{E}\Big(X_s(X_t-X_s)\Big) + \mathbb{E}\Big(X_s^2\Big)\\
&amp;=s=\min(s,t).
\end{align*}\]</span> En resumen, el movimiento Browniano es un proceso gaussiano con funciones de media y covarianza <span class="math inline">\(\mu_X(t)=0\)</span>, y <span class="math inline">\(C_X(s,t)=\min(s,t)\)</span>, respectivamente. En particular, observamos que este proceso no es estacionario (ni siquiera en el sentido débil), ya que en general no se verifica que <span class="math inline">\(C_X(s,t)=C_X(0,t-s)\)</span>. Por ejemplo, <span class="math inline">\(C_X(3,4)=\min(3,4)=3\)</span>; sin embargo, <span class="math inline">\(C_X(0,4-3)=\min(0,1)=0\)</span>.</p>
<p>A continuación vamos a detallar otra estrategia para simular el movimiente Browniano, la cual se basa en que dicho proceso es gaussiano. Aunque nos vamos a centrar en el caso particular del movimiento Browniano, este procedimiento sirve para simular cualquier proceso gaussiano conocidas sus funciones de media y covarianza. Fijados los tiempos <span class="math inline">\(t_1&lt;\ldots&lt;t_n\)</span> sabemos que el vector aleatorio <span class="math inline">\((X_{t_1},X_{t_2},\ldots,X_{t_n})\)</span> sigue una distribución multivariada de media <span class="math inline">\(\mu_X=0\)</span> y matriz de convarianzas <span class="math inline">\(C_X=(c_{i,j})_{n\times n}\)</span> donde <span class="math inline">\(c_{i,j}:=\min\{t_i,t_j\}\)</span>. De esta manera, podremos simular una trayectoria mediante la obtención de una muestra aleatoria del anterior vector aleatorio. Para ello utilizamos la libreria <em>mvtnorm</em> de <em>R</em>, la cual permite simular variables aleatorias normales multivariadas:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>tiempo <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">by=</span>dt)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos la matriz de covarianzas</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n, <span class="at">ncol =</span> n)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> dt<span class="sc">*</span><span class="fu">pmin</span>(<span class="fu">row</span>(C),<span class="fu">col</span>(C))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulamos una normal multivariada </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>, <span class="at">sigma=</span>C)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadimos el valor 0 inicial</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, x)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tiempo, x, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Tema1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="procesos-gaussianos-estacionarios-isotrópicos" class="level3" data-number="2.5.3">
<h3 data-number="2.5.3" class="anchored" data-anchor-id="procesos-gaussianos-estacionarios-isotrópicos"><span class="header-section-number">2.5.3</span> Procesos gaussianos estacionarios isotrópicos</h3>
<p>Un tipo particular de proceso gaussiano estacionario son los procesos gaussianos estacionarios isotrópicos. Decimos que un proceso gaussiano estacionario <span class="math inline">\((X_t)_{t\in\mathbb{T}}\)</span> es <strong>isotrópico</strong> si su función de medias es constante, <span class="math inline">\(\mu_X(t)=\mu\)</span>, y la función de covarianza depende sólo de la distancia <span class="math inline">\(|t-s|\)</span>, es decir,<br>
<span class="math display">\[
C_X(s,t)=K(|t-s|)
\]</span> para cierta función <span class="math inline">\(K\colon [0,\infty)\to [0,\infty)\)</span> llamada <em>núcleo</em>.</p>
<p>Tomemos por ejemplo <span class="math inline">\(\mu_X(t)=0\)</span> y el núcleo exponencial cuadrático <span class="math inline">\(K_l(x):=\exp(-x^2/2l^2)\)</span>, donde <span class="math inline">\(l\)</span> es un parámetro de escala. Vamos a simular en <em>R</em> una trayectoria de dicho proceso:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">112</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>tiempo <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">by=</span>dt)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos la matriz de covarianzas</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol =</span> n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> dt<span class="sc">*</span><span class="fu">abs</span>(<span class="fu">row</span>(C)<span class="sc">-</span><span class="fu">col</span>(C))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>C<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>l<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulamos una normal multivariada </span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>, <span class="at">sigma=</span>C)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tiempo, x, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Tema1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para analizar el comportamiento probabilístico, podemos simular diez trayectorias del proceso:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">112</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>tiempo <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">by=</span>dt)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos la matriz de covarianzas</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol =</span> n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> dt<span class="sc">*</span><span class="fu">abs</span>(<span class="fu">row</span>(C)<span class="sc">-</span><span class="fu">col</span>(C))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>C<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>l<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulamos una normal multivariada </span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>, <span class="at">sigma=</span>C)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>colores <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="dv">10</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tiempo, x, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>), <span class="at">col=</span>colores[<span class="dv">1</span>])</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nsim){</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>,<span class="at">sigma=</span>C)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(tiempo, x, <span class="at">col=</span>colores[i])</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Tema1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>A diferencia del movimiento Browniano, vemos que las trayectorias presentan un comportamiento estacionario, ya que su distribución es la misma a lo largo del tiempo. Otra diferencia con el movimiento Browniano es que las trayectorias tienen una apariencia suave.</p>
<p>Podemos cambiar el parámero de escala, tomando <span class="math inline">\(l=0.1\)</span>. De este modo obtenemos las trayectorias:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Tema1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Tomemos ahora el núcleo de Ornstein–Uhlenbeck <span class="math inline">\(K_l(x):=\exp(-|x|/l)\)</span>.</p>
<p>Simulemos algunas trayectorias en <em>R</em>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>tiempo <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">by=</span>dt)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos la matriz de covarianzas</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol =</span> n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> dt<span class="sc">*</span><span class="fu">abs</span>(<span class="fu">row</span>(C)<span class="sc">-</span><span class="fu">col</span>(C))</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>C<span class="sc">/</span>l)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulamos una normal multivariada </span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>, <span class="at">sigma=</span>C)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>colores <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="dv">10</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tiempo, x, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>), <span class="at">col=</span>colores[<span class="dv">1</span>])</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nsim){</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>,<span class="at">sigma=</span>C)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(tiempo, x, <span class="at">col=</span>colores[i])</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Tema1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Vemos que las trayectorias tienen una apariencia más irregular la cual nos recuerda al movimiento Browniano. Sin embargo, en este caso tenemos un proceso estacionario cuyas trayectorias se comportan de manera similar a lo largo del tiempo.</p>
</section>
<section id="movimiento-browniano-fraccional" class="level3" data-number="2.5.4">
<h3 data-number="2.5.4" class="anchored" data-anchor-id="movimiento-browniano-fraccional"><span class="header-section-number">2.5.4</span> Movimiento Browniano fraccional</h3>
<p>Otro proceso gaussiano importante es el <strong>movimiento Browniano fraccional</strong>, el cual es una generalización del movimiento Browniano clásico. A diferencia de éste, los incrementos del movimiento Browniano fraccional no son independientes.</p>
<p>Dado un número <span class="math inline">\(H \in (0,1)\)</span>, decimos que un proceso estocástico <span class="math inline">\((X_t)_{t\in [0,\infty)}\)</span> es un <strong>movimiento Browniano fraccional con índice de Hurst</strong> <span class="math inline">\(H\)</span> si es un proceso gaussiano, su función de medias es constantemente cero, <span class="math inline">\(\mu_X(t)=0\)</span>, y su función de covarianzas está dada por <span class="math display">\[
C_X(s,t) = \frac{1}{2}\left( t^{2H} + s^{2H} - |t-s|^{2H} \right).
\]</span> El índice de Hurst <span class="math inline">\(H\)</span> describe la irregularidad del movimiento resultante: valores más altos producen trayectorias más suaves. Este proceso fue introducido por Mandelbrot y Van Ness (1968) para modelizar fenómenos como los mercados financieros.</p>
<ul>
<li>Cuando <span class="math inline">\(H = \tfrac{1}{2}\)</span>, el proceso coincide con el movimiento Browniano usual.</li>
<li>Cuando <span class="math inline">\(H &gt; \tfrac{1}{2}\)</span>, los incrementos están positivamente correlados.</li>
<li>Cuando <span class="math inline">\(H &lt; \tfrac{1}{2}\)</span>, los incrementos están negativamente correlados.</li>
</ul>
<p>Vamos a simular en <em>R</em> una trayectoria de dicho proceso para H=0.2:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>tiempo <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">by=</span>dt)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos la matriz de covarianzas para H=0.2</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n, <span class="at">ncol =</span> n)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>((dt<span class="sc">*</span><span class="fu">row</span>(C))<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>H) <span class="sc">+</span> (dt<span class="sc">*</span><span class="fu">col</span>(C))<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>H) <span class="sc">-</span> <span class="fu">abs</span>(<span class="fu">row</span>(C) <span class="sc">-</span> <span class="fu">col</span>(C))<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>H))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulamos una normal multivariada </span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>, <span class="at">sigma=</span>C)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadimos el valor 0 inicial</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, x)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tiempo, x, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Tema1_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Vemos que la trayectoria obtenida menos suave que en el caso del movimiento Browniano usual. Al igual que el movimiento Browniano usual, no es un proceso estacionario.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Presentación</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Tema2.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tema 2. Cadenas de Markov</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>